<div class="col-lg-4 col-md-6">
    <div class="single-product">
        <div class="product-img">
            <img class="card-img"
                 src="@Card.ImageUrl"
                 alt="" />
            <div class="p_icon">
                <a href="#">
                    <i class="ti-eye"></i>
                </a>
                <a href="#">
                    <i class="ti-heart"></i>
                </a>
                <a @onclick="(() => this.AddProductToBasket(Card.Id, 1))">
                    <i class="ti-shopping-cart"></i>
                </a>
            </div>
        </div>
        <div class="product-btm">
            <a href="/SdvShop/Shop/Product/@Card.Id" class="d-block">
                <h4>@Card.Name</h4>
            </a>
            <div class="mt-3">
                <span class="mr-4">@Card.Price</span>
                <del>$35.00</del>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter]
    public ProductCardViewModel Card { get; set; }

    private async Task AddProductToBasket(string id, int count)
    {
        var oldValue = await this.SessionStorage.GetItemAsync<List<AddedProductViewModel>>("CodeShop");

        if (oldValue.Any(x => x.Id == id))
        {
            oldValue.FirstOrDefault(x => x.Id == id).Quantity += count;
        }
        else
        {
            oldValue.Add(new AddedProductViewModel
            {
                Id = id,
                Quantity = count,
            });
        }

        await this.SessionStorage.SetItemAsync("CodeShop", oldValue);
        this.StateHasChanged();
    }
}